/** ****************************************************************************************************
 * @file
 * @brief トランスフォーム情報格納用
 **************************************************************************************************** */
#pragma once

namespace MySystem
{
	/** ****************************************************************************************************
	 * @brief トランスフォーム情報格納用
	 **************************************************************************************************** */
	class Transform
	{
	public:
		using Position	= Vec2;		//!< 座標用
		using Scale		= Vec2;		//!< 大きさ用
		using Angle		= double;	//!< 角度用

	private:
		Position	_localPosition;	//!< 自身の座標
		Scale		_localScale;	//!< 自身の大きさ
		Angle		_localAngle;	//!< 自身の角度

		Position	_worldPosition;	//!< 座標
		Scale		_worldScale;	//!< 大きさ
		Angle		_worldAngle;	//!< 角度

		Transform*			_parent;	//!< 親
		Array<Transform*>	_children;	//!< 子供達

	public:
		/** ****************************************************************************************************
		 * @brief コンストラクタ
		 **************************************************************************************************** */
		Transform() noexcept;

		/** ****************************************************************************************************
		 * @brief コンストラクタ
		 * @param[in] parent	親
		 **************************************************************************************************** */
		Transform(Transform* pParent) noexcept;

		/** ****************************************************************************************************
		 * @brief				コンストラクタ
		 * @param[in] position	座標
		 * @param[in] scale		大きさ
		 * @param[in] angle		角度
		 **************************************************************************************************** */
		Transform(const Position& position, const Scale& scale, const Angle& angle) noexcept;

		/** ****************************************************************************************************
		 * @brief				コンストラクタ
		 * @param[in] position	座標
		 * @param[in] scale		大きさ
		 * @param[in] angle		角度
		 * @param[in] parent	親
		 **************************************************************************************************** */
		Transform(const Position& position, const Scale& scale, const Angle& angle, Transform* parent) noexcept;

		/** ****************************************************************************************************
		 * @brief デストラクタ
		 **************************************************************************************************** */
		virtual ~Transform() noexcept;

		/** ****************************************************************************************************
		 * @brief トランスフォーム情報の更新
		 **************************************************************************************************** */
		void UpdateTransform() noexcept;

		/** ****************************************************************************************************
		 * @brief				親設定
		 * @param[in] parent	親
		 **************************************************************************************************** */
		void SetParent(Transform* parent) noexcept;

		/** ****************************************************************************************************
		 * @brief			子供設定
		 * @param[in] child	子供
		 **************************************************************************************************** */
		void SetChild(Transform* child) noexcept;

		/** ****************************************************************************************************
		 * @brief	親取得
		 * @return	親
		 **************************************************************************************************** */
		[[nodiscard]]
		Transform* GetParent() noexcept;

		/** ****************************************************************************************************
		 * @brief			子供取得
		 * @param[in] index	欲しい子供の番号
		 * @retval			子供
		 * @retval nullptr	子供がいなかった
		 **************************************************************************************************** */
		[[nodiscard]]
		Transform* GetChild(const size_t index) noexcept;

		/** ****************************************************************************************************
		 * @brief	子供をすべて取得
		 * @return	子供たち
		 **************************************************************************************************** */
		[[nodiscard]]
		Array<Transform*> GetChildren() noexcept;

		/** ****************************************************************************************************
		 * @brief	子供の数取得
		 * @return	子供の数
		 **************************************************************************************************** */
		[[nodiscard]]
		size_t GetChildCount() noexcept;

		/** ****************************************************************************************************
		 * @brief			親を持っているか
		 * @retval true		持っている
		 * @retval false	持っていない
		 **************************************************************************************************** */
		[[nodiscard]]
		bool HasParent() noexcept;

		/** ****************************************************************************************************
		 * @brief				ローカルの座標変更
		 * @param[in] position	座標
		 **************************************************************************************************** */
		void SetLocalPosition(const Position& position) noexcept;

		/** ****************************************************************************************************
		 * @brief			ローカルの大きさ変更
		 * @param[in] scale	大きさ
		 **************************************************************************************************** */
		void SetLocalScale(const Scale& scale) noexcept;

		/** ****************************************************************************************************
		 * @brief			ローカルの角度変更
		 * @param[in] angle	角度
		 **************************************************************************************************** */
		void SetLocalAngle(const Angle& angle) noexcept;

		/** ****************************************************************************************************
		 * @brief				ワールド座標からローカルの座標変更
		 * @param[in] position	ワールド座標
		 **************************************************************************************************** */
		void SetWorldPosition(const Position& position) noexcept;

		/** ****************************************************************************************************
		 * @brief			ワールドスケールからローカルの大きさ変更
		 * @param[in] scale	ワールドスケール
		 **************************************************************************************************** */
		void SetWorldScale(const Scale& scale) noexcept;

		/** ****************************************************************************************************
		 * @brief			ワールドアングルからローカルの角度変更
		 * @param[in] scale	ワールドアングル
		 **************************************************************************************************** */
		void SetWorldAngle(const Angle& angle) noexcept;

		/** ****************************************************************************************************
		 * @brief	ローカル座標取得
		 * @return	ローカル座標
		 **************************************************************************************************** */
		Position GetLocalPosition() const noexcept;

		/** ****************************************************************************************************
		 * @brief	ローカルスケール取得
		 * @return	ローカルスケール
		 **************************************************************************************************** */
		Scale GetLocalScale() const noexcept;

		/** ****************************************************************************************************
		 * @brief	ローカルアングル取得
		 * @return	ローカルアングル
		 **************************************************************************************************** */
		Angle GetLocalAngle() const noexcept;

		/** ****************************************************************************************************
		 * @brief	ワールド座標取得
		 * @return	ワールド座標
		 **************************************************************************************************** */
		Position GetWorldPosition() const noexcept;

		/** ****************************************************************************************************
		 * @brief	ワールドスケール取得
		 * @return	ワールドスケール
		 **************************************************************************************************** */
		Scale GetWorldScale() const noexcept;

		/** ****************************************************************************************************
		 * @brief	ワールドアングル取得
		 * @return	ワールドアングル
		 **************************************************************************************************** */
		Angle GetWorldAngle() const noexcept;
	};
}

